<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: PostCard/PostInteractions/PostInteractions.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: PostCard/PostInteractions/PostInteractions.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/* eslint-disable react/jsx-curly-newline */
/* eslint-disable implicit-arrow-linebreak */
/* eslint-disable no-nested-ternary */
/* eslint-disable no-unused-vars */
/* eslint-disable operator-linebreak */
/* eslint-disable no-param-reassign */
/* eslint-disable react/jsx-one-expression-per-line */
/* eslint-disable jsx-a11y/anchor-is-valid */
/* eslint-disable jsx-a11y/no-static-element-interactions */
/* eslint-disable jsx-a11y/click-events-have-key-events */
/* eslint-disable react/prop-types */
import { useState, memo } from 'react';
import './PostInteractions.css';
import { RiSpam3Line } from 'react-icons/ri';
import { BsThreeDots, BsShareFill } from 'react-icons/bs';
import { BiHide } from 'react-icons/bi';
import { CiCircleRemove } from 'react-icons/ci';
import {
  AiOutlineCheck,
  AiOutlineTag,
  AiFillUnlock,
  AiFillLock,
  AiFillWarning,
  AiOutlineWarning
} from 'react-icons/ai';
import {
  hidePost,
  unHidePost,
  lockPost,
  unLockPost,
  unMarkPostAsNSFW,
  markPostAsNSFW
} from '../../../../services/requests/Post';
import FlairDialog from './FlairDialog';

/**
 * @typedef PropType
 * @property {string} postId
 * @property {function} setNsfw
 * @property {function} setLocked
 * @property {bool} isLocked
 * @property {bool} isPostApproved
 * @property {bool} isPostRemoved
 * @property {bool} isPostSpammed
 * @property {bool} isNSFW
 * @property {bool} isSpoiled
 * @property {bool} replyNotifications
 * @property {bool} showComments
 * @property {function} handleApproveButton
 * @property {function} handleRemoveButton
 * @property {function} handleSpamButton
 * @property {string} whichQueue
 */

/**
 * This Component for the post's interaction (comment, share, hide, etc).
 * It just listens to the user interaction and handles it.
 *
 */
function PostInteractions({
  postId,
  setNsfw,
  setLocked,
  isLocked,
  isPostApproved,
  isPostRemoved,
  isPostSpammed,
  isNSFW,
  isSpoiled,
  replyNotifications,
  showComments,
  handleApproveButton,
  handleRemoveButton,
  handleSpamButton,
  whichQueue
}) {
  // states
  const [isApproved, setIsApproved] = useState(isPostApproved);
  const [replyNotificationsState, setReplyNotificationsState] =
    useState(replyNotifications);

  const [lockComments, setLockComments] = useState(isLocked);
  const [lockThread, setLockThread] = useState(isLocked);
  const [markedAsNSFW, setMarkedAsNSFW] = useState(isNSFW);
  const [markedAsSpoiler, setMarkedAsSpoiler] = useState(isSpoiled);
  const [isRemoved, setIsRemoved] = useState(isPostRemoved);
  const [isSpammed, setIsSpammed] = useState(isPostSpammed);
  const [openFlairDialog, setOpenFlairDialog] = useState(false);
  const [hidePostState, setHidePostState] = useState(false);

  /* This function shows the dropdown for more interactions on the post */
  const handleClickMoreInteractions = () => {
    // showing the dropdown
    document
      .getElementById(`interactions-dropdown-${postId}`)
      .classList.toggle('is-visible');

    // hiding the other dropdown
    document
      .getElementById(`post-options-${postId}`)
      .classList.remove('is-visible');
  };

  /* This function shows the dropdown for the post options */
  const handleClickOnPostOptions = () => {
    // showing the dropdown
    document
      .getElementById(`post-options-${postId}`)
      .classList.toggle('is-visible');
    // hiding the other dropdown
    document
      .getElementById(`interactions-dropdown-${postId}`)
      .classList.remove('is-visible');
  };

  const handleHideButton = () => {
    if (hidePostState) {
      setHidePostState(false);
      unHidePost({ id: postId });
    } else {
      setHidePostState(true);
      hidePost({ id: postId });
    }
  };

  const handleLockComments = () => {
    if (!lockComments) {
      setLockComments(true);
      setLocked(true);
      const info = { request: { is_locked: true }, id: postId };
      lockPost(info);
    } else {
      setLockComments(false);
      setLocked(false);
      const info = { request: { is_locked: false }, id: postId };
      unLockPost(info);
    }
  };

  const handleMarkAsNSFW = () => {
    if (!markedAsNSFW) {
      setMarkedAsNSFW(true);
      setNsfw(true);
      markPostAsNSFW({ id: postId });
    } else {
      setMarkedAsNSFW(false);
      setNsfw(false);
      unMarkPostAsNSFW({ id: postId });
    }
  };

  const handleOpenFlairDialog = () => {
    setOpenFlairDialog(true);
  };

  const handleCloseFlairDialog = () => {
    setOpenFlairDialog(false);
  };

  // Returning the result
  return (
    &lt;div
      className="post-interactions"
      data-testid="test-post-interactions"
    >
      &lt;div className="post-interaction-content">
        {/* Add removal reason card  */}
        &lt;FlairDialog
          open={openFlairDialog}
          handleClose={handleCloseFlairDialog}
          postId={postId}
          subredditName="testing"
        />

        {whichQueue === 'unmoderated' ? (
          &lt;>
            {/* approve  */}
            {!isApproved ? (
              &lt;a
                className="post-approve"
                onClick={() =>
                  handleApproveButton(
                    postId,
                    setIsApproved,
                    setIsRemoved,
                    setIsSpammed
                  )
                }
                style={{
                  paddingTop: '.7rem',
                  paddingBottom: '.7rem'
                }}
              >
                &lt;AiOutlineCheck
                  fontSize="20px"
                  style={{
                    marginRight: '5px'
                  }}
                />
                &lt;span> Approve&lt;/span>
              &lt;/a>
            ) : (
              &lt;a
                className="post-approve"
                style={{
                  paddingTop: '.7rem',
                  paddingBottom: '.7rem',
                  color: '#19ff00',
                  cursor: 'now-allowed'
                }}
              >
                &lt;AiOutlineCheck
                  fontSize="20px"
                  style={{
                    marginRight: '5px',
                    cursor: 'now-allowed'
                  }}
                />
                &lt;span> Approved&lt;/span>
              &lt;/a>
            )}

            {/* remove  */}
            {!isRemoved &amp;&amp; !isSpammed ? (
              &lt;a
                className="post-approve"
                onClick={() =>
                  handleRemoveButton(
                    postId,
                    setIsApproved,
                    setIsRemoved,
                    setIsSpammed
                  )
                }
                style={{
                  paddingTop: '.7rem',
                  paddingBottom: '.7rem'
                }}
              >
                &lt;CiCircleRemove
                  fontSize="20px"
                  style={{
                    marginRight: '5px'
                  }}
                />
                &lt;span> Remove&lt;/span>
              &lt;/a>
            ) : (
              &lt;a
                className="post-approve"
                style={{
                  paddingTop: '.7rem',
                  paddingBottom: '.7rem',
                  color: 'red'
                }}
              >
                &lt;CiCircleRemove
                  fontSize="20px"
                  style={{
                    marginRight: '5px'
                  }}
                />
                &lt;span> Removed&lt;/span>
              &lt;/a>
            )}
          &lt;/>
        ) : null}

        {whichQueue === 'spam' ? (
          &lt;>
            {/* approve  */}
            {isSpammed || isRemoved ? (
              &lt;a
                className="post-approve"
                onClick={() =>
                  handleApproveButton(
                    postId,
                    setIsApproved,
                    setIsRemoved,
                    setIsSpammed
                  )
                }
                style={{
                  paddingTop: '.7rem',
                  paddingBottom: '.7rem'
                }}
              >
                &lt;AiOutlineCheck
                  fontSize="20px"
                  style={{
                    marginRight: '5px'
                  }}
                />
                &lt;span> Approve&lt;/span>
              &lt;/a>
            ) : null}

            {/* remove  */}
            {isApproved ? (
              &lt;a
                className="post-approve"
                onClick={() =>
                  handleRemoveButton(
                    postId,
                    setIsApproved,
                    setIsRemoved,
                    setIsSpammed
                  )
                }
                style={{
                  paddingTop: '.7rem',
                  paddingBottom: '.7rem'
                }}
              >
                &lt;CiCircleRemove
                  fontSize="20px"
                  style={{ marginRight: '5px' }}
                />
                &lt;span> Remove&lt;/span>
              &lt;/a>
            ) : null}
          &lt;/>
        ) : null}

        {whichQueue === 'edited' ? (
          &lt;>
            {/* approve  */}
            {isRemoved || isSpammed ? (
              &lt;a
                className="post-approve"
                onClick={() => handleApproveButton(postId)}
                style={{
                  paddingTop: '.7rem',
                  paddingBottom: '.7rem'
                }}
              >
                &lt;AiOutlineCheck
                  fontSize="20px"
                  style={{
                    marginRight: '5px'
                  }}
                />
                &lt;span> Approve&lt;/span>
              &lt;/a>
            ) : null}

            {/* remove  */}
            {isApproved ? (
              &lt;a
                className="post-approve"
                onClick={() => handleRemoveButton(postId)}
                style={{
                  paddingTop: '.7rem',
                  paddingBottom: '.7rem'
                }}
              >
                &lt;CiCircleRemove
                  fontSize="20px"
                  style={{ marginRight: '5px' }}
                />
                &lt;span> Remove&lt;/span>
              &lt;/a>
            ) : null}
          &lt;/>
        ) : null}

        {/* flair  */}
        {!showComments ? (
          &lt;a
            className="post-flair"
            onClick={handleOpenFlairDialog}
            style={{
              paddingTop: '.7rem',
              paddingBottom: '.7rem'
            }}
          >
            &lt;AiOutlineTag
              fontSize="20px"
              style={{
                marginRight: '5px'
              }}
            />
            &lt;span> Flair&lt;/span>
          &lt;/a>
        ) : null}

        {/* other interactions  */}
        &lt;a
          className="post-more-interactions"
          data-testid="test-post-more-interactions"
        >
          &lt;a onClick={handleClickMoreInteractions}>
            &lt;BsThreeDots
              fontSize="18px"
              color="#949494"
            />
            &lt;div
              className="interactions-dropdown"
              id={`interactions-dropdown-${postId}`}
              data-testid="test-2-interactions-dropdown"
            >
              {/* mark as spam  */}
              &lt;div
                className="drop-down-item"
                onClick={handleSpamButton}
              >
                {isApproved ? (
                  &lt;a onClick={() => handleSpamButton(postId)}>
                    &lt;RiSpam3Line fontSize="20px" />
                    &lt;span> Remove As spam &lt;/span>
                  &lt;/a>
                ) : null}
              &lt;/div>

              {/* lock thread  */}
              {showComments ? (
                &lt;div
                  className="drop-down-item"
                  onClick={handleLockComments}
                >
                  &lt;a>
                    {lockThread ? (
                      &lt;>
                        &lt;AiFillUnlock fontSize="20px" />
                        &lt;span> Unlock Thread&lt;/span>
                      &lt;/>
                    ) : (
                      &lt;>
                        &lt;AiFillLock fontSize="20px" />
                        &lt;span> Lock Thread&lt;/span>
                      &lt;/>
                    )}
                  &lt;/a>
                &lt;/div>
              ) : (
                /* lock comment  */
                &lt;div
                  className="drop-down-item"
                  onClick={handleLockComments}
                >
                  &lt;a>
                    {lockComments ? (
                      &lt;>
                        &lt;AiFillUnlock fontSize="20px" />
                        &lt;span> Unlock Comments&lt;/span>
                      &lt;/>
                    ) : (
                      &lt;>
                        &lt;AiFillLock fontSize="20px" />
                        &lt;span> Lock Comments&lt;/span>
                      &lt;/>
                    )}
                  &lt;/a>
                &lt;/div>
              )}

              {/* mark as nsfw  */}
              {!showComments ? (
                &lt;div
                  className="drop-down-item"
                  onClick={handleMarkAsNSFW}
                >
                  &lt;a>
                    {markedAsNSFW ? (
                      &lt;>
                        &lt;AiFillWarning fontSize="20px" />
                        &lt;span> un-Mark As NSFW &lt;/span>
                      &lt;/>
                    ) : (
                      &lt;>
                        &lt;AiOutlineWarning fontSize="20px" />
                        &lt;span> Mark As NSFW &lt;/span>
                      &lt;/>
                    )}
                  &lt;/a>
                &lt;/div>
              ) : null}

              {/* hide  */}
              {!showComments ? (
                &lt;div
                  className="post-hide"
                  onClick={handleHideButton}
                >
                  {hidePostState ? (
                    &lt;a>
                      &lt;BiHide fontSize="25px" />
                      &lt;span> un-Hide&lt;/span>
                    &lt;/a>
                  ) : (
                    &lt;a>
                      &lt;BiHide fontSize="25px" />
                      &lt;span> hide&lt;/span>
                    &lt;/a>
                  )}
                &lt;/div>
              ) : null}

              {/* share  */}
              &lt;div
                className="post-hide"
                onClick={handleHideButton}
              >
                &lt;a>
                  &lt;BsShareFill fontSize="20px" />
                  &lt;span> share&lt;/span>
                &lt;/a>
              &lt;/div>
            &lt;/div>
          &lt;/a>
        &lt;/a>
      &lt;/div>
    &lt;/div>
  );
}

export default memo(PostInteractions);
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#FlairDialog">FlairDialog</a></li><li><a href="global.html#ModQueue">ModQueue</a></li><li><a href="global.html#PostCard">PostCard</a></li><li><a href="global.html#PostContainer">PostContainer</a></li><li><a href="global.html#PostContent">PostContent</a></li><li><a href="global.html#PostInfo">PostInfo</a></li><li><a href="global.html#PostInteractions">PostInteractions</a></li><li><a href="global.html#Voting">Voting</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.11</a> on Fri Dec 23 2022 12:02:40 GMT+0200 (Eastern European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
